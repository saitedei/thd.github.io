import { useState } from 'react';

export default function ReconciliationPage() {
  const [rejectCount, setRejectCount] = useState(0);
  const [isReconciled, setIsReconciled] = useState(false);
  const [heartIcon, setHeartIcon] = useState('â¤ï¸');
  const [message, setMessage] = useState('');

  // æ‹’ç»æŒ‰é’®çš„æç¤ºä¿¡æ¯
  const rejectMessages = [
    "å†è€ƒè™‘ä¸€ä¸‹å¥½å—ï¼Ÿ",
    "çœŸçš„ä¸å†æƒ³æƒ³å—ï¼Ÿ",
    "æˆ‘ä¼šç­‰ä½ çš„...",
    "æˆ‘çš„å¿ƒå¥½ç—›...",
    "æœ€åä¸€æ¬¡æœºä¼šäº†...",
    "ğŸ˜­ å¥½å§ï¼Œæˆ‘å°Šé‡ä½ çš„å†³å®š"
  ];

  // çˆ±å¿ƒå›¾æ ‡é›†åˆ
  const heartIcons = [
    "â¤ï¸", "ğŸ’”", "ğŸ’“", "ğŸ’", "ğŸ’•", "ğŸ’–", 
    "ğŸ’—", "ğŸ’˜", "ğŸ’™", "ğŸ’š", "ğŸ’›", "ğŸ§¡", "ğŸ’œ"
  ];

  const handleReject = () => {
    if (rejectCount < rejectMessages.length) {
      const newMessage = rejectMessages[rejectCount];
      setMessage(newMessage);
      
      // å¦‚æœæ˜¯æœ€åä¸€æ¬¡æ‹’ç»ï¼Œæ˜¾ç¤ºç‰¹æ®Šæ¶ˆæ¯
      if (rejectCount === rejectMessages.length - 1) {
        setHeartIcon("ğŸ’”");
      } else {
        // éšæœºé€‰æ‹©ä¸€ä¸ªçˆ±å¿ƒå›¾æ ‡ï¼ˆæ’é™¤å½“å‰çš„å’Œå¿ƒç¢çš„ï¼‰
        const availableIcons = heartIcons.filter(icon => 
          icon !== heartIcon && icon !== "ğŸ’”"
        );
        const randomIndex = Math.floor(Math.random() * availableIcons.length);
        setHeartIcon(availableIcons[randomIndex]);
      }
      
      setRejectCount(rejectCount + 1);
      
      // 3ç§’åæ¸…é™¤æ¶ˆæ¯
      setTimeout(() => {
        if (!isReconciled) setMessage('');
      }, 3000);
    }
  };

  const handleReconcile = () => {
    setIsReconciled(true);
    setMessage("å¤ªæ£’äº†ï¼æˆ‘ä»¬å’Œå¥½å•¦ï¼ğŸ‰");
    setHeartIcon("ğŸ¥°");
    
    // 3ç§’åæ¸…é™¤æ¶ˆæ¯
    setTimeout(() => {
      setMessage('');
    }, 3000);
  };

  return (
    <div className={`min-h-screen flex flex-col items-center justify-center p-4 transition-colors duration-500 ${
      isReconciled ? 'bg-pink-100' : 'bg-gray-50'
    }`}>
      <div className="text-center">
        <div className="text-9xl mb-6 transition-transform duration-300 hover:scale-110">
          {heartIcon}
        </div>
        
        <h1 className="text-3xl font-bold mb-8 text-gray-800">
          æˆ‘ä»¬å’Œå¥½å§ï¼Œå¥½å—ï¼Ÿ
        </h1>
        
        <div className="flex flex-col sm:flex-row gap-4 justify-center">
          <button
            onClick={handleReconcile}
            disabled={isReconciled}
            className={`px-8 py-4 rounded-full text-xl font-bold transition-all ${
              isReconciled 
                ? 'bg-gray-300 cursor-not-allowed' 
                : 'bg-pink-500 hover:bg-pink-600 text-white shadow-lg hover:shadow-xl'
            }`}
          >
            â¤ï¸å’Œå¥½â¤ï¸
          </button>
          
          <button
            onClick={handleReject}
            disabled={isReconciled || rejectCount >= rejectMessages.length}
            className={`px-8 py-4 rounded-full text-xl font-bold transition-all ${
              isReconciled || rejectCount >= rejectMessages.length
                ? 'bg-gray-300 cursor-not-allowed' 
                : 'bg-gray-200 hover:bg-gray-300 text-gray-800 shadow-md hover:shadow-lg'
            }`}
          >
            ä¸è¦
          </button>
        </div>
        
        {message && (
          <div className="mt-6 p-4 bg-black bg-opacity-70 text-white rounded-lg max-w-md mx-auto animate-fadeIn">
            {message}
          </div>
        )}
      </div>
    </div>
  );
}
